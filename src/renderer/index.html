<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Apple Music Downloader</title>
    <link rel="stylesheet" href="styles.css" />
    <script src="./vue.global.js"></script>
  </head>
  <body>
    <div class="app" id="app">
      <!-- Ëá™ÂÆö‰πâÊ†áÈ¢òÊ†è -->
      <div class="titlebar">
        <div class="titlebar-content">
          <div class="titlebar-title">
            <span class="app-icon">üéµ</span>
            <span class="app-name">Apple Music Downloader</span>
          </div>
          <div class="titlebar-controls">
            <button
              class="titlebar-button minimize-btn"
              @click="minimizeWindow"
              title="ÊúÄÂ∞èÂåñ"
            >
              <svg width="10" height="10" viewBox="0 0 10 10">
                <rect x="0" y="4" width="10" height="2" fill="currentColor" />
              </svg>
            </button>
            <button
              class="titlebar-button maximize-btn"
              @click="maximizeWindow"
              title="ÊúÄÂ§ßÂåñ"
            >
              <svg width="10" height="10" viewBox="0 0 10 10">
                <rect
                  x="0"
                  y="0"
                  width="10"
                  height="10"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="1"
                />
              </svg>
            </button>
            <button
              class="titlebar-button close-btn"
              @click="closeWindow"
              title="ÂÖ≥Èó≠"
            >
              <svg width="10" height="10" viewBox="0 0 10 10">
                <path
                  d="M0,0 L10,10 M10,0 L0,10"
                  stroke="currentColor"
                  stroke-width="1"
                />
              </svg>
            </button>
          </div>
        </div>
      </div>

      <div class="container">
        <!-- ‰∏ãËΩΩÂå∫Âüü -->
        <div class="download-section" v-if="!isDownloading">
          <div class="download-card">
            <h3>‰∏ãËΩΩÈü≥‰πê</h3>

            <div class="form-group">
              <label for="music-url">Apple Music ÈìæÊé•:</label>
              <input
                type="url"
                id="music-url"
                v-model="musicUrl"
                placeholder="https://music.apple.com/..."
                @input="validateForm"
              />
            </div>

            <div class="form-group">
              <label for="output-path">‰∏ãËΩΩË∑ØÂæÑ:</label>
              <div class="path-input-group">
                <input
                  type="text"
                  id="output-path"
                  v-model="outputPath"
                  placeholder="Ê≠£Âú®ËÆæÁΩÆÈªòËÆ§‰∏ãËΩΩË∑ØÂæÑ..."
                  readonly
                />
                <button @click="selectDownloadFolder" class="btn btn-secondary">
                  ÈÄâÊã©Êñá‰ª∂Â§π
                </button>
              </div>
              <small class="path-hint"
                >ÈªòËÆ§‰∏ãËΩΩÂà∞Á®ãÂ∫èÁõÆÂΩïÁöÑ download Êñá‰ª∂Â§π</small
              >
            </div>

            <div class="form-actions">
              <button
                @click="startDownload"
                class="btn btn-primary"
                :disabled="!isFormValid || isDownloading"
                :class="{ loading: isDownloading }"
              >
                <span class="btn-text">ÂºÄÂßã‰∏ãËΩΩ</span>
                <span class="btn-loading" v-show="isDownloading"
                  >‰∏ãËΩΩ‰∏≠...</span
                >
              </button>
            </div>
          </div>
        </div>

        <div class="progress-section" v-show="showProgress">
          <!-- ÂΩìÂâçÊ≠åÊõ≤‰ø°ÊÅØ -->
          <div class="current-song-info" v-show="currentSong.title">
            <div class="song-title">{{ currentSong.title }}</div>
            <div class="song-progress">{{ currentSong.progress }}</div>
          </div>

          <!-- ‰∏ãËΩΩÁªüËÆ°‰ø°ÊÅØ -->
          <div class="download-stats" v-show="showStats">
            <div class="stat-item">
              <span class="stat-label">Êñá‰ª∂Â§ßÂ∞è:</span>
              <span class="stat-value">{{ downloadStats.fileSize }}</span>
            </div>
            <div class="stat-item">
              <span class="stat-label">‰∏ãËΩΩÈÄüÂ∫¶:</span>
              <span class="stat-value">{{ downloadStats.speed }}</span>
            </div>
            <div class="stat-item">
              <span class="stat-label">Ââ©‰ΩôÊó∂Èó¥:</span>
              <span class="stat-value">{{ downloadStats.eta }}</span>
            </div>
            <div class="stat-item">
              <span class="stat-label">Â∑≤Áî®Êó∂Èó¥:</span>
              <span class="stat-value">{{ downloadStats.elapsed }}</span>
            </div>
          </div>

          <div ref="progressLog" class="progress-log">
            <div
              v-for="(log, index) in progressLogs"
              :key="index"
              class="log-entry"
            >
              {{ log }}
            </div>
          </div>
        </div>
      </div>

      <div class="footer">
        <!-- ËøõÂ∫¶Âå∫Âüü -->
        <div class="progress-footer">
          <h3>‰∏ãËΩΩËøõÂ∫¶</h3>
          <div class="progress-bar">
            <div
              class="progress-fill"
              :style="{ width: progressPercentage + '%' }"
            ></div>
          </div>
          <div class="progress-text">{{ progressText }}</div>
        </div>
      </div>
    </div>

    <script src="renderer.js"></script>
  </body>
</html>
